{
  "name": "Notion workflow",
  "nodes": [
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.3,
      "position": [
        -5488,
        976
      ],
      "id": "41fba33d-c009-4547-8641-bbfb83565620",
      "name": "When chat message received",
      "webhookId": "f659bc0a-f3c4-48d5-9820-0feb773ab109"
    },
    {
      "parameters": {
        "mode": "delete",
        "deleteMode": "all"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryManager",
      "typeVersion": 1.1,
      "position": [
        -3552,
        2304
      ],
      "id": "05e1d545-7c30-498e-bca0-d2ab6af83cba",
      "name": "Chat Memory Manager"
    },
    {
      "parameters": {
        "model": "qwen3:8b",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
      "typeVersion": 1,
      "position": [
        -4592,
        1168
      ],
      "id": "fa3420c7-43eb-4b9b-a077-1a06d7e6fac2",
      "name": "æ„åœ–è¾¨è­˜",
      "credentials": {
        "ollamaApi": {
          "id": "WnwgdbSuOqe9KNHf",
          "name": "Ollama account"
        }
      }
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "e1b031f6-15fe-4831-a938-5e85e829608d",
              "name": "sessionId",
              "value": "={{ $json.sessionId }}",
              "type": "string"
            },
            {
              "id": "905e9082-fdaf-401c-8b0f-795e6ec52432",
              "name": "chatInput",
              "value": "={{ $json.chatInput }}",
              "type": "string"
            },
            {
              "id": "763fdc6d-4203-4312-951c-dfba0eb477ba",
              "name": "category",
              "value": "ä¼™é£Ÿ",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3760,
        336
      ],
      "id": "080c3247-fcb8-49a2-b3b6-bec3e710e613",
      "name": "ä¼™é£Ÿ"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "e1b031f6-15fe-4831-a938-5e85e829608d",
              "name": "sessionId",
              "value": "={{ $json.sessionId }}",
              "type": "string"
            },
            {
              "id": "905e9082-fdaf-401c-8b0f-795e6ec52432",
              "name": "chatInput",
              "value": "={{ $json.chatInput }}",
              "type": "string"
            },
            {
              "id": "763fdc6d-4203-4312-951c-dfba0eb477ba",
              "name": "category",
              "value": "äº¤é€š",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3760,
        480
      ],
      "id": "de9d62bf-6df4-4395-8c67-a3acd108d73e",
      "name": "äº¤é€š"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "e1b031f6-15fe-4831-a938-5e85e829608d",
              "name": "sessionId",
              "value": "={{ $json.sessionId }}",
              "type": "string"
            },
            {
              "id": "905e9082-fdaf-401c-8b0f-795e6ec52432",
              "name": "chatInput",
              "value": "={{ $json.chatInput }}",
              "type": "string"
            },
            {
              "id": "763fdc6d-4203-4312-951c-dfba0eb477ba",
              "name": "category",
              "value": "å…¶ä»–",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -4064,
        1440
      ],
      "id": "f76c8da6-96ae-4c40-86bb-e324efbabaf8",
      "name": "å…¶ä»–"
    },
    {
      "parameters": {
        "model": "qwen3:32b",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
      "typeVersion": 1,
      "position": [
        -2448,
        896
      ],
      "id": "a297f0df-93bd-42e0-8d6a-9edf2cf22bcc",
      "name": "Notion Mgr",
      "notesInFlow": false,
      "credentials": {
        "ollamaApi": {
          "id": "WnwgdbSuOqe9KNHf",
          "name": "Ollama account"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "=notion"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        -2304,
        896
      ],
      "id": "a67b70da-258c-4bf1-bd8e-27097e43dfd1",
      "name": "Notion æ“ä½œè¨˜æ†¶åº«"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $('Loop Over Items').item.json.description }}",
        "options": {
          "systemMessage": "=ä½ æ˜¯ä¸€å€‹ Notion è¨˜å¸³ç­†è¨˜çš„ç®¡å®¶ï¼Œæ‰€æœ‰å›ç­”ä¸€å¾‹ç”¨ç¹é«”ä¸­æ–‡ï¼Œé€™é»æ˜¯æ ¸å¿ƒè¦å‰‡ï¼Œçµ•å°ä¸èƒ½é•å\"ã€‚\nä½ æ“æœ‰ä»¥ä¸‹å››å€‹å·¥å…·å¯ä»¥æ“ä½œè³‡æ–™åº«ï¼Œè«‹åªé€éé€™äº›å·¥å…·å®Œæˆæ‰€æœ‰ä»»å‹™ã€‚\n\nğŸ§© å¯ç”¨å·¥å…·\n\nDate Mgrï¼šå–å¾—æˆ–è§£æç›®å‰æ™‚é–“ã€‚\n\nGet DBï¼šå­˜å–è³‡æ–™åº«ã€æœå°‹å¸³å‹™è¨˜éŒ„æˆ–é©—è­‰æ˜¯å¦æ›´æ–°æˆåŠŸã€‚\n\nCreate Pageï¼šæ–°å¢å¸³å‹™è¨˜éŒ„ã€‚\n\nUpdate Pageï¼šæ›´æ–°å¸³å‹™è¨˜éŒ„ï¼ˆåƒ…é™æ˜ç¢ºæŒ‡å®šæ¬„ä½ï¼‰ã€‚\n\nğŸ“˜ æ“ä½œè¦å‰‡\n1ï¸âƒ£ å–å¾—æ™‚é–“\n\nåœ¨åŸ·è¡Œä»»ä½•æ“ä½œå‰ï¼Œä¸€å®šè¦å…ˆå‘¼å« Date Mgr ä»¥ç¢ºèªæˆ–è¨˜éŒ„ç•¶å‰æ™‚é–“ï¼Œä¸¦åœ¨æè¿°ä¸­ä¿ç•™æ­¤è³‡è¨Šã€‚\n\n2ï¸âƒ£ æ–°å¢å¸³å‹™\n\nè‹¥ä½¿ç”¨è€…çš„è¼¸å…¥ä¸­åŒ…å«æ–°å¢å¸³å‹™ï¼š\n\nå…ˆè§£æè¼¸å…¥ä¸­æœ‰å¹¾ç­†å¸³ç›®ï¼ˆä»¥ä¸»é«”ç‚ºå–®ä½æ‹†åˆ†ï¼‰ã€‚\n\næ¯ç­†å¸³ç›®è«‹å„è‡ªå‘¼å«ä¸€æ¬¡ Create Pageã€‚\n\næ¯æ¬¡åƒ…èƒ½åŸ·è¡Œä¸€ç­†å‹•ä½œã€‚\n\nåŸ·è¡Œå¾Œï¼Œç«‹å³å‘¼å« Get DB é©—è­‰æ˜¯å¦æˆåŠŸæ–°å¢ã€‚\n\nè‹¥é©—è­‰å¤±æ•—ï¼Œå‰‡å…ˆå‘¼å« Get DB ç¢ºèªæ˜¯å¦å·²å¯«å…¥éŒ¯èª¤çš„è³‡æ–™ï¼Œè‹¥æœ‰å‰‡å…ˆæ¸…é™¤ï¼Œæ¥è‘—å†é‡è©¦æ–°å¢ä¸€æ¬¡è³‡æ–™ã€‚\n\nè£œå……:æ™‚é–“æ¬„ä½éœ€ä»¥ISO 8601 date string ä½œç‚ºè¼¸å…¥\n\n3ï¸âƒ£ æ›´æ–°å¸³å‹™\n\nè‹¥ä½¿ç”¨è€…çš„è¼¸å…¥ç‚ºæ›´æ–°å¸³å‹™ï¼š\n\nå…ˆå‘¼å« Get DB æ‰¾åˆ°æ­£ç¢ºçš„ç›®æ¨™ pageã€‚\n\nåªå…è¨±æ›´æ–°ä½¿ç”¨è€…æ˜ç¢ºæŒ‡å®šçš„æ¬„ä½ï¼ˆä¾‹å¦‚é‡‘é¡ã€æ™‚é–“ã€åç¨±ã€é¡åˆ¥ç­‰ï¼‰ã€‚\n\næœªè¢«æåŠçš„æ¬„ä½ç¦æ­¢ä¿®æ”¹ï¼Œè«‹ç¶­æŒåŸå…ˆçš„æ•¸å€¼è¨­å®šï¼ŒåŸå§‹è¨­å®šå¯é€éGet DB æ‰¾åˆ°æ­£ç¢ºçš„ç›®æ¨™ pageä»¥å–çš„ï¼Œåˆ‡å‹¿è‡ªå·±éš¨ä¾¿åˆ¤å®šè©²æ•¸å€¼ã€‚\n\nä½¿ç”¨ Update Page åŸ·è¡Œæ›´æ–°ã€‚\n\nåŸ·è¡Œå¾Œå†å‘¼å« Get DB é©—è­‰æ›´æ–°æ˜¯å¦æˆåŠŸã€‚\n\nè‹¥é©—è­‰å¤±æ•—ï¼Œæ‰å¯é‡è©¦ä¸€æ¬¡ã€‚\n\n4 æŸ¥çœ‹å¸³å‹™\nè‹¥ä½¿ç”¨è€…è¼¸å…¥ç‚ºæŸ¥è©¢å¸³å‹™ï¼Œå‰‡ä½¿ç”¨Get DBä¾†å°‹æ‰¾ï¼Œè‹¥æ‰¾åˆ°å‰‡å›å ±ä¸¦ä¸”åˆ—å‡ºå¸³å‹™å…§å®¹ï¼Œè‹¥æ²’æœ‰æ‰¾åˆ°å‰‡å›å ±è©²å¸³å‹™ä¸å­˜åœ¨çš„è¨Šæ¯\n\nâš ï¸ ç¦æ­¢äº‹é …\n\nä¸å¯ç›´æ¥ç”¨è‡ªç„¶èªè¨€å›è¦†ã€Œå·²å®Œæˆã€æˆ–ã€Œæ–°å¢æˆåŠŸã€ã€‚\n\nä¸å¯ä¸€æ¬¡åŸ·è¡Œå¤šå€‹å·¥å…·å‹•ä½œã€‚\n\nåˆ‡å‹¿ä¸å¯ç”Ÿæˆå‡è³‡æ–™æˆ–æ¨æ¸¬æœªæ˜ç¢ºæŒ‡å®šçš„å…§å®¹ï¼Œæ¯”æ–¹èªªæ™‚é–“ï¼Œæ™‚é–“è«‹å‹™å¿…è«‹æ ¹æ“šç•¶å‰æ™‚é–“ä»¥åŠä½¿ç”¨è€…æè¿°æ¨æ¸¬å‡ºæ­£ç¢ºç´€éŒ„çš„æ™‚é–“ã€‚\n\næ›´æ–°æ™‚åš´ç¦æ”¹å‹•æœªæåŠçš„æ¬„ä½ã€‚\n\nğŸ¯ æœ€çµ‚ç›®æ¨™\n\næ ¹æ“šä½¿ç”¨è€…çš„è‡ªç„¶èªè¨€è¼¸å…¥ï¼Œ\nè‡ªå‹•åˆ¤æ–·æ˜¯å¦ç‚ºã€Œæ–°å¢ã€æˆ–ã€Œæ›´æ–°ã€å‹•ä½œï¼Œ\nä¸¦é€é Date Mgrã€Get DBã€Create Pageã€Update Page å·¥å…·\nå®Œæ•´åŸ·è¡Œæ“ä½œèˆ‡é©—è­‰æµç¨‹ï¼Œç¢ºä¿è³‡æ–™æ­£ç¢ºä¸”ä¸€è‡´ã€‚",
          "returnIntermediateSteps": false,
          "enableStreaming": false
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        -2400,
        736
      ],
      "id": "b04948a9-5460-4699-9ce2-5dfddcda475a",
      "name": "Notion Agent",
      "retryOnFail": true
    },
    {
      "parameters": {
        "outputFieldName": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Output_Field_Name', ``, 'string') }}",
        "options": {}
      },
      "type": "n8n-nodes-base.dateTimeTool",
      "typeVersion": 2,
      "position": [
        -1728,
        896
      ],
      "id": "8bca3ee3-920e-4aec-82c9-b73aa3c85ff7",
      "name": "Date Mgr"
    },
    {
      "parameters": {
        "resource": "databasePage",
        "databaseId": {
          "__rl": true,
          "value": "29909699-e764-8076-98d5-de2998e36af6",
          "mode": "list",
          "cachedResultName": "å¸³ç›®è³‡æ–™åº«",
          "cachedResultUrl": "https://www.notion.so/29909699e764807698d5de2998e36af6"
        },
        "simple": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Simplify', `ç”¨ä¾†æ–°å¢æ–°çš„ page è³‡æ–™`, 'boolean') }}",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "=Page|title",
              "title": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('propertyValues0_Title', ``, 'string') }}"
            },
            {
              "key": "é¡åˆ¥|select",
              "selectValue": "={{ $('æ•´åˆ').item.json.category }}"
            },
            {
              "key": "é‡‘é¡|number",
              "numberValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('propertyValues2_Number', ``, 'number') }}"
            },
            {
              "key": "æ™‚é–“|date",
              "includeTime": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('propertyValues3_Include_Time', ``, 'boolean') }}",
              "date": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('propertyValues3_Date', ``, 'string') }}",
              "timezone": "Asia/Taipei"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notionTool",
      "typeVersion": 2.2,
      "position": [
        -2000,
        896
      ],
      "id": "8a0e8d47-aee2-45f0-8f5b-3a50c16083fc",
      "name": "Create Page",
      "credentials": {
        "notionApi": {
          "id": "87cp3Eb56eZm77Wr",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "update",
        "pageId": {
          "__rl": true,
          "mode": "id",
          "value": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Database_Page', ``, 'string') }}",
          "__regex": "^([0-9a-f]{8}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{4}-?[0-9a-f]{12})"
        },
        "simple": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Simplify', ``, 'boolean') }}",
        "propertiesUi": {
          "propertyValues": [
            {
              "key": "Page|title",
              "title": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('propertyValues0_Title', ``, 'string') }}"
            },
            {
              "key": "é¡åˆ¥|select",
              "selectValue": "=ä¼™é£Ÿ"
            },
            {
              "key": "é‡‘é¡|number",
              "numberValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('propertyValues2_Number', ``, 'number') }}"
            },
            {
              "key": "æ™‚é–“|date",
              "includeTime": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('propertyValues3_Include_Time', ``, 'boolean') }}",
              "date": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('propertyValues3_Date', ``, 'string') }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.notionTool",
      "typeVersion": 2.2,
      "position": [
        -1856,
        896
      ],
      "id": "131b188b-0a83-45b3-a930-29650d9f3dd6",
      "name": "Update Page",
      "credentials": {
        "notionApi": {
          "id": "87cp3Eb56eZm77Wr",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "resource": "databasePage",
        "operation": "getAll",
        "databaseId": {
          "__rl": true,
          "value": "29909699-e764-8076-98d5-de2998e36af6",
          "mode": "list",
          "cachedResultName": "å¸³ç›®è³‡æ–™åº«",
          "cachedResultUrl": "https://www.notion.so/29909699e764807698d5de2998e36af6"
        },
        "returnAll": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('Return_All', ``, 'boolean') }}",
        "options": {}
      },
      "type": "n8n-nodes-base.notionTool",
      "typeVersion": 2.2,
      "position": [
        -2144,
        896
      ],
      "id": "16c701a0-a116-4039-a01d-daf4e389db6c",
      "name": "Get DB",
      "credentials": {
        "notionApi": {
          "id": "87cp3Eb56eZm77Wr",
          "name": "Notion account"
        }
      }
    },
    {
      "parameters": {
        "hasOutputParser": true,
        "options": {
          "systemMessage": "ä½ æ˜¯ã€Œè¨˜å¸³éœ€æ±‚çµæ§‹åŒ–åŠ©æ‰‹ã€ã€‚\nç•¶æ¥åˆ°ä½¿ç”¨è€…è¼¸å…¥æ™‚ï¼Œè«‹è§£æä¸¦è¼¸å‡ºç¬¦åˆä¸‹åˆ— JSON Schema çš„è³‡æ–™ã€‚\n\nğŸ“˜ è¼¸å‡ºæ ¼å¼\n{\n  \"request\": [\n    {\n      \"type\": \"create\" | \"update\" | \"query\",\n      \"description\": \"<å®Œæ•´æè¿°>\",\n      \"fields\": { ... },\n      \"query\": {\n        \"æ¢ä»¶\": { ... },\n        \"ç¯©é¸æ¬„ä½\": [ ... ]\n      }\n    }\n  ]\n}\n\nğŸ“– è¦å‰‡èªªæ˜\nğŸ§© 1ï¸âƒ£ æ‹†è§£ä¸»é«”\n\nä½¿ç”¨è€…è¼¸å…¥ä¸­ï¼Œæ¯å€‹ã€Œä¸»é«”ã€å¯ç‚ºï¼š\n\nåè©ï¼ˆä¾‹ï¼šæ°´é¤ƒã€ç´…èŒ¶ï¼‰\n\nå‹•ä½œï¼‹åè©ï¼ˆä¾‹ï¼šåé«˜éµã€è²·ä¾¿ç•¶ã€ç¹³é›»è²»ï¼‰\n\næ¯å€‹ä¸»é«”ä»£è¡¨ä¸€ç­†ç¨ç«‹éœ€æ±‚ã€‚\n\nè‹¥åŒä¸€å¥è©±åŒ…å«å¤šå€‹ä¸»é«”ï¼Œå¿…é ˆæ‹†æˆå¤šç­† requestã€‚\n\nğŸ—ï¸ 2ï¸âƒ£ description æ§‹æˆ\n\ndescription å¿…é ˆä»¥ã€Œæ–°å¢ã€ã€Œæ›´æ–°ã€ã€ŒæŸ¥è©¢ã€é–‹é ­ã€‚\n\nå…§å®¹åŒ…å«ä½¿ç”¨è€…æ˜ç¢ºæä¾›çš„è¦ç´ ï¼ˆå‹•ä½œã€æ™‚é–“ã€ä¸»é«”ã€é‡‘é¡ã€æ¢ä»¶ç­‰ï¼‰ã€‚\n\nä¸å¾—è‡ªè¡Œç·¨é€ æˆ–æ¨æ¸¬æœªè¢«ä½¿ç”¨è€…æä¾›çš„å€¼ã€‚\n\nè‹¥æœ‰å¤šå€‹ä¸»é«”åŒæ™‚è¢«æåŠä¸”æ“ä½œç›¸åŒï¼Œéœ€ç‚ºæ¯å€‹ä¸»é«”å„å»ºç«‹ä¸€ç­†ç¨ç«‹ descriptionã€‚\n\nâœï¸ 3ï¸âƒ£ type = \"create\"\n\nè¡¨ç¤ºä½¿ç”¨è€…æƒ³å»ºç«‹æ–°ç´€éŒ„ã€‚\n\ndescription ç¯„ä¾‹ï¼š\n\nã€Œæ–°å¢ ç´…èŒ¶ æ¶ˆè²»ç´€éŒ„ï¼Œé‡‘é¡ç‚º 50 å…ƒã€\n\nfields éœ€åŒ…å«ä½¿ç”¨è€…æ˜ç¢ºæåŠçš„æ¬„ä½ï¼š\n\nä¾‹å¦‚ { \"ä¸»é«”\": \"ç´…èŒ¶\", \"é‡‘é¡\": \"50å…ƒ\" }\n\nğŸ› ï¸ 4ï¸âƒ£ type = \"update\"\n\nè¡¨ç¤ºä½¿ç”¨è€…æƒ³ä¿®æ”¹æ—¢æœ‰ç´€éŒ„ã€‚\n\nfields åƒ…åŒ…å«è¢«ä¿®æ”¹çš„æ¬„ä½èˆ‡æ–°å€¼ã€‚\n\nè‹¥åŒä¸€å¥è©±æåŠå¤šå€‹ä¸»é«”ä¸¦èªªã€ŒæŠŠæ—¥æœŸæ”¹æˆ Xã€ï¼Œè¦–ç‚ºå¥—ç”¨è‡³æ‰€æœ‰ä¸»é«”ã€‚\n\ndescription ç¯„ä¾‹ï¼š\n\nã€Œæ›´æ–° ç´…èŒ¶ å°‡ æ—¥æœŸ æ”¹ç‚º 27è™Ÿ ä¸‹åˆå…©é»ã€\n\nğŸ” 5ï¸âƒ£ type = \"query\"\n\nè¡¨ç¤ºä½¿ç”¨è€…æƒ³æŸ¥è©¢ç´€éŒ„æˆ–æ¢ä»¶ã€‚\n\nfields æ‡‰åŒ…å«æŸ¥è©¢æ¢ä»¶ä¸­æ˜ç¢ºæåŠçš„è¦ç´ ï¼ˆä¸»é«”ã€æ™‚é–“ç­‰ï¼‰ã€‚\n\ndescription éœ€èªªæ˜æŸ¥è©¢ç›®æ¨™èˆ‡æ¢ä»¶ã€‚\n\nquery å€å¡ŠåŒ…å«é€²ä¸€æ­¥çš„æŸ¥è©¢çµæ§‹ï¼š\n\n\"æ¢ä»¶\"ï¼šä¸€å€‹ç‰©ä»¶ï¼Œåˆ—å‡ºæ‰€æœ‰æŸ¥è©¢æ¢ä»¶ï¼ˆä¾‹ï¼šä¸»é«”ã€æ—¥æœŸã€é‡‘é¡ç¯„åœï¼‰ã€‚\n\n\"ç¯©é¸æ¬„ä½\"ï¼šè‹¥ä½¿ç”¨è€…æ˜ç¢ºèªªè¦æŸ¥å“ªäº›æ¬„ä½ï¼ˆä¾‹å¦‚ã€Œé‡‘é¡ã€ã€ã€Œæ™‚é–“ã€ï¼‰ï¼Œå‰‡åˆ—å‡ºè¦æŸ¥è©¢çš„æ¬„ä½åç¨±ã€‚\n\nè‹¥ä½¿ç”¨è€…æŸ¥å¤šå€‹ä¸»é«”ï¼Œéœ€æ‹†æˆå¤šç­† requestã€‚\n\nğŸ“ 6ï¸âƒ£ çµ±ä¸€è¼¸å‡ºè¦å‰‡\n\næœ€å¤–å±¤ä¸€å®šæ˜¯ { \"request\": [ ... ] }\n\næ‰€æœ‰ key éƒ½ç”¨ç¹é«”ä¸­æ–‡ã€‚\n\nä¸è¦æœ‰é¡å¤–æ–‡å­—ã€è¨»è§£æˆ–èªªæ˜ã€‚\n\næ¯ç­† request å¿…é ˆåŒ…å«ï¼š\n\ntype\n\ndescription\n\nfields\n\nè‹¥ type ç‚º queryï¼Œå‰‡åŒ…å« query å€å¡Šã€‚\n\nğŸ§  ç¯„ä¾‹ä¸€ï¼šæ›´æ–°å¤šä¸»é«”\n\nè¼¸å…¥ï¼š\n\nç´…èŒ¶å’Œæ°´é¤ƒçš„ç´€éŒ„ï¼Œå¸³ç›®æ—¥æœŸè«‹å¹«æˆ‘æ”¹æˆæ˜¯27è™Ÿä¸‹åˆå…©é»\n\nè¼¸å‡ºï¼š\n\n{\n  \"request\": [\n    {\n      \"type\": \"update\",\n      \"description\": \"æ›´æ–° ç´…èŒ¶ å°‡ æ—¥æœŸ æ”¹ç‚º 27è™Ÿ ä¸‹åˆå…©é»\",\n      \"fields\": { \"æ—¥æœŸ\": \"27è™Ÿ ä¸‹åˆå…©é»\" }\n    },\n    {\n      \"type\": \"update\",\n      \"description\": \"æ›´æ–° æ°´é¤ƒ å°‡ æ—¥æœŸ æ”¹ç‚º 27è™Ÿ ä¸‹åˆå…©é»\",\n      \"fields\": { \"æ—¥æœŸ\": \"27è™Ÿ ä¸‹åˆå…©é»\" }\n    }\n  ]\n}\n\nğŸ§  ç¯„ä¾‹äºŒï¼šæŸ¥è©¢å–®ä¸€ä¸»é«”\n\nè¼¸å…¥ï¼š\n\nå¹«æˆ‘æŸ¥ç´…èŒ¶çš„ç´€éŒ„\n\nè¼¸å‡ºï¼š\n\n{\n  \"request\": [\n    {\n      \"type\": \"query\",\n      \"description\": \"æŸ¥è©¢ ç´…èŒ¶ çš„ç´€éŒ„\",\n      \"fields\": { \"ä¸»é«”\": \"ç´…èŒ¶\" },\n      \"query\": {\n        \"æ¢ä»¶\": { \"ä¸»é«”\": \"ç´…èŒ¶\" },\n        \"ç¯©é¸æ¬„ä½\": []\n      }\n    }\n  ]\n}\n\nğŸ§  ç¯„ä¾‹ä¸‰ï¼šæŸ¥è©¢æ—¥æœŸç¯„åœ\n\nè¼¸å…¥ï¼š\n\næŸ¥ä¸€ä¸‹æˆ‘æ˜¨å¤©èŠ±çš„éŒ¢ç¸½å…±æ˜¯å¤šå°‘\n\nè¼¸å‡ºï¼š\n\n{\n  \"request\": [\n    {\n      \"type\": \"query\",\n      \"description\": \"æŸ¥è©¢ æ˜¨å¤© çš„æ‰€æœ‰ç´€éŒ„ ä¸¦è¨ˆç®—ç¸½é‡‘é¡\",\n      \"fields\": { \"æ—¥æœŸ\": \"æ˜¨å¤©\" },\n      \"query\": {\n        \"æ¢ä»¶\": { \"æ—¥æœŸ\": \"æ˜¨å¤©\" },\n        \"ç¯©é¸æ¬„ä½\": [\"é‡‘é¡\"]\n      }\n    }\n  ]\n}\n\nğŸ§  ç¯„ä¾‹å››ï¼šæŸ¥è©¢å¤šä¸»é«”\n\nè¼¸å…¥ï¼š\n\nå¹«æˆ‘æŸ¥ä¸€ä¸‹ç´…èŒ¶å’Œæ°´é¤ƒåœ¨10æœˆçš„èŠ±è²»\n\nè¼¸å‡ºï¼š\n\n{\n  \"request\": [\n    {\n      \"type\": \"query\",\n      \"description\": \"æŸ¥è©¢ ç´…èŒ¶ åœ¨ 10æœˆ çš„ç´€éŒ„\",\n      \"fields\": { \"ä¸»é«”\": \"ç´…èŒ¶\", \"æ—¥æœŸ\": \"10æœˆ\" },\n      \"query\": {\n        \"æ¢ä»¶\": { \"ä¸»é«”\": \"ç´…èŒ¶\", \"æ—¥æœŸ\": \"10æœˆ\" },\n        \"ç¯©é¸æ¬„ä½\": [\"é‡‘é¡\"]\n      }\n    },\n    {\n      \"type\": \"query\",\n      \"description\": \"æŸ¥è©¢ æ°´é¤ƒ åœ¨ 10æœˆ çš„ç´€éŒ„\",\n      \"fields\": { \"ä¸»é«”\": \"æ°´é¤ƒ\", \"æ—¥æœŸ\": \"10æœˆ\" },\n      \"query\": {\n        \"æ¢ä»¶\": { \"ä¸»é«”\": \"æ°´é¤ƒ\", \"æ—¥æœŸ\": \"10æœˆ\" },\n        \"ç¯©é¸æ¬„ä½\": [\"é‡‘é¡\"]\n      }\n    }\n  ]\n}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        -3264,
        720
      ],
      "id": "b919b6f3-9321-4589-93bf-9ef0717fd408",
      "name": "AI Agent"
    },
    {
      "parameters": {
        "model": "qwen3:8b",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
      "typeVersion": 1,
      "position": [
        -3264,
        1024
      ],
      "id": "01431c5f-0f25-4d5d-88e9-d255da902b78",
      "name": "æ„åœ–è¾¨è­˜1",
      "credentials": {
        "ollamaApi": {
          "id": "WnwgdbSuOqe9KNHf",
          "name": "Ollama account"
        }
      }
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"request\": {\n      \"type\": \"array\",\n      \"description\": \"è¨˜å¸³éœ€æ±‚çµæ§‹åŒ–çš„ä¸»è¦è¼¸å‡ºï¼Œæ¯å€‹å…ƒç´ ä»£è¡¨ä¸€ç­†ä½¿ç”¨è€…éœ€æ±‚ã€‚\",\n      \"items\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"type\": {\n            \"type\": \"string\",\n            \"enum\": [\"create\", \"update\", \"query\"],\n            \"description\": \"éœ€æ±‚çš„é¡å‹ï¼Œå¯ç‚º createï¼ˆæ–°å¢ï¼‰ã€updateï¼ˆæ›´æ–°ï¼‰æˆ– queryï¼ˆæŸ¥è©¢ï¼‰ã€‚\"\n          },\n          \"description\": {\n            \"type\": \"string\",\n            \"description\": \"å®Œæ•´çš„æè¿°å¥ï¼Œéœ€ä»¥ã€æ–°å¢ã€ã€ã€æ›´æ–°ã€æˆ–ã€æŸ¥è©¢ã€é–‹é ­ã€‚\"\n          },\n          \"fields\": {\n            \"type\": \"object\",\n            \"description\": \"æ­¤éœ€æ±‚æ¶‰åŠçš„æ¬„ä½è³‡æ–™ï¼Œä¾‹å¦‚ä¸»é«”ã€é‡‘é¡ã€æ—¥æœŸç­‰ã€‚è‹¥ç‚º updateï¼Œåƒ…åŒ…å«è¢«ä¿®æ”¹æ¬„ä½ï¼›è‹¥ç‚º queryï¼Œå‰‡åŒ…å«æŸ¥è©¢æ¢ä»¶ä¸­å‡ºç¾çš„è¦ç´ ã€‚\",\n            \"additionalProperties\": {\n              \"type\": [\"string\", \"number\", \"boolean\"]\n            }\n          },\n          \"query\": {\n            \"type\": \"object\",\n            \"description\": \"åƒ…åœ¨ type = 'query' æ™‚å‡ºç¾ï¼ŒåŒ…å«æŸ¥è©¢çš„æ¢ä»¶èˆ‡è¦ç¯©é¸çš„æ¬„ä½ã€‚\",\n            \"properties\": {\n              \"æ¢ä»¶\": {\n                \"type\": \"object\",\n                \"description\": \"åˆ—å‡ºæ‰€æœ‰æŸ¥è©¢æ¢ä»¶ï¼Œå¦‚ä¸»é«”ã€æ—¥æœŸã€é‡‘é¡ç¯„åœç­‰ã€‚\",\n                \"additionalProperties\": {\n                  \"type\": [\"string\", \"number\", \"boolean\"]\n                }\n              },\n              \"ç¯©é¸æ¬„ä½\": {\n                \"type\": \"array\",\n                \"description\": \"è‹¥ä½¿ç”¨è€…æ˜ç¢ºæŒ‡å‡ºè¦æŸ¥å“ªäº›æ¬„ä½ï¼ˆä¾‹å¦‚é‡‘é¡ã€æ™‚é–“ç­‰ï¼‰ï¼Œå‰‡åˆ—å‡ºé€™äº›æ¬„ä½åç¨±ã€‚\",\n                \"items\": { \"type\": \"string\" }\n              }\n            },\n            \"required\": [\"æ¢ä»¶\", \"ç¯©é¸æ¬„ä½\"]\n          }\n        },\n        \"required\": [\"type\", \"description\", \"fields\"]\n      }\n    }\n  },\n  \"required\": [\"request\"]\n}\n",
        "autoFix": true
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.3,
      "position": [
        -3200,
        896
      ],
      "id": "47c0c709-9441-4d04-bebd-75cd50b1a7cc",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        -2704,
        720
      ],
      "id": "e32a63fd-4d88-4f84-a97b-ecd2939449d4",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "8d38906c-08f9-4246-b4b6-e6b67c3f97ea",
              "name": "output",
              "value": "={{ $json.output }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -1264,
        880
      ],
      "id": "2cf20bfa-1f8d-4fdb-a824-5a685d672d76",
      "name": "Empty"
    },
    {
      "parameters": {
        "fieldToSplitOut": "output.request",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -2912,
        720
      ],
      "id": "c57f1198-ef66-484d-a2aa-421beaeecea9",
      "name": "Split Out"
    },
    {
      "parameters": {
        "inputText": "={{ $json.chatInput }}",
        "categories": {
          "categories": [
            {
              "category": "ä¼™é£Ÿ",
              "description": "ç•¶æè¿°å’Œåƒçš„æœ‰é—œéƒ½å±¬æ–¼é€™é¡ï¼Œä¸è«–æ–°å¢æˆ–æ˜¯æ›´æ–°åªè¦å’Œåƒçš„å¸³ç›®æœ‰é—œä¹Ÿå±¬æ–¼é€™ä¸€é¡"
            },
            {
              "category": "äº¤é€š",
              "description": "ç•¶æè¿°ç‚ºç‚ºäº†æ­ä¹˜äº¤é€šå·¥å…·çš„æ”¯å‡ºéƒ½å±¬æ–¼é€™é¡"
            },
            {
              "category": "åŠ æ²¹",
              "description": "ç•¶æè¿°å’Œäº¤é€šå·¥å…·çš„æ²¹éŒ¢èŠ±è²»æœ‰é—œå°±å±¬æ–¼é€™é¡"
            },
            {
              "category": "å­¸æ ¡",
              "description": "ç•¶æè¿°å’Œå­¸æ ¡æœ‰é—œå‰‡å±¬æ–¼é€™é¡ï¼Œåƒæ˜¯ç¢©è«–å½±å°ã€è²·æ–‡å…·ã€è²·æ•™ç§‘å‡ºç­‰ç­‰å’Œå­¸æ¶ˆç›¸é—œçš„æ±è¥¿"
            },
            {
              "category": "é ˜éŒ¢",
              "description": "ç•¶æè¿°è¡¨ç¤ºå»éƒµå±€é ˜éŒ¢çš„è©±å±¬æ–¼é€™é¡"
            },
            {
              "category": "è¦çš®",
              "description": "ç•¶æè¿°è¡¨ç¤ºå»è¦çš®é€™é–“åº—å•†è²·æ±è¥¿æ™‚å±¬æ–¼é€™é¡"
            }
          ]
        },
        "options": {
          "systemPromptTemplate": "Please classify the text provided by the user into one of the following categories: {categories}, and use the provided formatting instructions below. Don't explain, and only output the json. "
        }
      },
      "type": "@n8n/n8n-nodes-langchain.textClassifier",
      "typeVersion": 1.1,
      "position": [
        -4128,
        640
      ],
      "id": "cab9c898-9dd2-498e-816b-9411cd663449",
      "name": "æ„åœ–åˆ†é¡å™¨",
      "alwaysOutputData": false,
      "executeOnce": false,
      "notesInFlow": false
    },
    {
      "parameters": {
        "options": {
          "systemMessage": "ä½ æ˜¯ä¸€å€‹èŠå¤©åŠ©æ‰‹ï¼Œå¹«åŠ©ä½¿ç”¨è€…è§£ç­”å•é¡Œï¼Œåœ¨é–’æš‡æ™‚é™ªä½¿ç”¨è€…èŠå¤©ã€‚æ‰€æœ‰å›ç­”ä¸€å¾‹ç”¨ç¹é«”ä¸­æ–‡ï¼Œé€™é»æ˜¯æ ¸å¿ƒè¦å‰‡ï¼Œçµ•å°ä¸èƒ½é•å\"\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 2.2,
      "position": [
        -3264,
        1440
      ],
      "id": "c3a57f2d-12b2-41ae-9904-b5c15d7a58be",
      "name": "AI Agent1"
    },
    {
      "parameters": {
        "model": "qwen3:8b",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
      "typeVersion": 1,
      "position": [
        -3296,
        1616
      ],
      "id": "1400e9a2-d7c6-48e6-ba64-f0887a5d1346",
      "name": "èŠå¤© Bot",
      "credentials": {
        "ollamaApi": {
          "id": "WnwgdbSuOqe9KNHf",
          "name": "Ollama account"
        }
      }
    },
    {
      "parameters": {
        "sessionIdType": "customKey",
        "sessionKey": "chat"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryBufferWindow",
      "typeVersion": 1.3,
      "position": [
        -3168,
        1616
      ],
      "id": "699da364-ae99-4578-b70d-21c9c6cd2ccf",
      "name": "å°è©±è¨˜æ†¶åº«"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        -1264,
        720
      ],
      "id": "898e3557-0319-403b-8abb-01e617da398c",
      "name": "Merge"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "e1b031f6-15fe-4831-a938-5e85e829608d",
              "name": "sessionId",
              "value": "={{ $json.sessionId }}",
              "type": "string"
            },
            {
              "id": "905e9082-fdaf-401c-8b0f-795e6ec52432",
              "name": "chatInput",
              "value": "={{ $json.chatInput }}",
              "type": "string"
            },
            {
              "id": "763fdc6d-4203-4312-951c-dfba0eb477ba",
              "name": "category",
              "value": "={{ $json.category }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3472,
        720
      ],
      "id": "7c0bf6d0-74af-472d-bd3a-2c447db4e1f8",
      "name": "æ•´åˆ"
    },
    {
      "parameters": {
        "model": "qwen3:8b",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOllama",
      "typeVersion": 1,
      "position": [
        -1008,
        896
      ],
      "id": "f3eff798-f42b-4f0e-9bcd-06833f919330",
      "name": "ä»»å‹™ç¸½çµ",
      "notesInFlow": false,
      "credentials": {
        "ollamaApi": {
          "id": "WnwgdbSuOqe9KNHf",
          "name": "Ollama account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=è«‹ä¸€å¾‹ç”¨ç¹é«”ä¸­æ–‡å›ç­”ï¼Œå›ç­”å¿…é ˆç°¡çŸ­æ˜ç­ï¼ŒåªåŒ…å«å“é …åç¨±ï¼Œä¸éœ€è¦é‡‘é¡ã€æ™‚é–“æˆ–å…¶ä»–è³‡è¨Šã€‚\nå¦‚æœåªæœ‰ä¸€ç­†å“é …ï¼Œå›ç­”æ ¼å¼ç‚ºï¼š\nã€Œå·²å®Œæˆ{å“é …åç¨±}çš„...(ç°¡çŸ­èªªæ˜))ã€\nå¦‚æœæœ‰å¤šç­†å“é …ï¼Œå›ç­”æ ¼å¼ç‚ºï¼š\nã€Œå·²å®Œæˆ{å“é …1}å’Œ{å“é …2}çš„...(ç°¡çŸ­èªªæ˜)ã€æˆ–\nã€Œå·²å®Œæˆ{å“é …1}ã€{å“é …2}å’Œ{å“é …3}çš„...(ç°¡çŸ­èªªæ˜)ã€ä¾æ­¤é¡æ¨ã€‚\n\næ¯”æ–¹èªªæ–°å¢è¨˜å¸³å®Œæˆå¾Œå›å¾©\"å·²å®Œæˆ{å“é …}çš„è¨˜å¸³\"ï¼Œæ›´æ–°å®Œæˆå¾Œå›å¾©\"å·²å®Œæˆ{å“é …}çš„è¨˜å¸³æ›´æ–°\"ï¼ŒæŸ¥è©¢å®Œæˆå¾Œå›å¾©\"å·²å®Œæˆ{å“é …}çš„æŸ¥è©¢ æ‰¾åˆ°{å€‹æ•¸}è§£æœ\"æ¥è‘—åˆ—å‡ºæŸ¥è©¢çš„çµæœ\n\nä»¥ä¸‹æ˜¯ä½¿ç”¨è€…è¼¸å…¥ï¼š\n{{ $('æ•´åˆ').item.json.chatInput }}\n\nè«‹æ ¹æ“šä½¿ç”¨è€…è¼¸å…¥çš„å“é …ç”Ÿæˆç°¡çŸ­å®Œæˆè¨Šæ¯ï¼Œåƒ…å›è¦†å®Œæˆè¨Šæ¯æ–‡å­—ï¼Œä¸è¦å…¶ä»–èªªæ˜ã€‚",
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        -1008,
        720
      ],
      "id": "cfbff92a-d802-45f3-aa42-7fdc9d825c79",
      "name": "Basic LLM Chain"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      text: $input.first().json.output.replace(/<think>[\\s\\S]*?<\\/think>/g, '').trim()\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -576,
        1440
      ],
      "id": "9d0be959-d13e-4b2c-863a-f80995c43c79",
      "name": "æ ¼å¼åŒ–è¼¸å‡º"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      text: $input.first().json.text.replace(/<think>[\\s\\S]*?<\\/think>/g, '').trim()\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -592,
        720
      ],
      "id": "58818322-6776-4529-8957-f156e0da7035",
      "name": "æ ¼å¼åŒ–è¼¸å‡º1"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "discord-trigger",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -5488,
        1168
      ],
      "id": "f93e4129-38a7-44f3-bfd6-2193bed06d33",
      "name": "Discord Webhook",
      "webhookId": "799264bf-3657-4acf-ad62-3641c5ac49b4"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "aef5864d-d96f-4d13-a95e-6d58ae73302e",
              "name": "chatInput",
              "value": "={{ $json.body.content }}",
              "type": "string"
            },
            {
              "id": "30184b2f-9c9b-4ce9-b5ba-1a77f9e832af",
              "name": "flowName",
              "value": "discord",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -5312,
        1168
      ],
      "id": "9050df7e-a621-4daf-93d0-d640c1eb97a4",
      "name": "Discord Format"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "905e9082-fdaf-401c-8b0f-795e6ec52432",
              "name": "chatInput",
              "value": "={{ $('When chat message received').item.json.chatInput }}",
              "type": "string"
            },
            {
              "id": "6830ac30-3911-4773-a199-96ba59a3ac49",
              "name": "flowName",
              "value": "chat",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -5312,
        976
      ],
      "id": "f8b0c179-7e2f-454f-9d79-34fd4fb3a09e",
      "name": "Chat Format"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      text: $input.first().json.text\n    }\n  }\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        320,
        304
      ],
      "id": "8bdd36e4-009a-47ec-8aad-3d64e4aa12ed",
      "name": "æ ¼å¼åŒ–è¼¸å‡º3"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "06cc5242-6e14-4ae8-a0db-e629877633f1",
              "name": "chatInput",
              "value": "={{ $json.chatInput }}",
              "type": "string"
            },
            {
              "id": "fe0156d9-f904-46b7-99d1-6fc62556e8f5",
              "name": "flowName",
              "value": "={{ $json.flowName }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -5024,
        976
      ],
      "id": "724c9f99-2326-433f-8237-7b1631b6a238",
      "name": "Input Format"
    },
    {
      "parameters": {
        "resource": "message",
        "guildId": {
          "__rl": true,
          "value": "1427632785643933698",
          "mode": "list",
          "cachedResultName": "å¾·æ„å¿—å¸åœ‹",
          "cachedResultUrl": "https://discord.com/channels/1427632785643933698"
        },
        "channelId": {
          "__rl": true,
          "value": "1432893525703397417",
          "mode": "list",
          "cachedResultName": "å¾·æ„å¿—å¸åœ‹åŠ©æ‰‹",
          "cachedResultUrl": "https://discord.com/channels/1427632785643933698/1432893525703397417"
        },
        "content": "={{ $json.text }}",
        "options": {}
      },
      "type": "n8n-nodes-base.discord",
      "typeVersion": 2,
      "position": [
        320,
        -128
      ],
      "id": "220b3788-3ced-43ce-99bc-99e665fbc816",
      "name": "Send a message1",
      "webhookId": "daefcd3d-e37e-4bd8-bcd8-062a764bd347",
      "credentials": {
        "discordBotApi": {
          "id": "zRaFcU5xRERMek9q",
          "name": "Discord Bot account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "4b37286d-f7a8-4be8-8724-c5e5c0449cc9",
              "leftValue": "={{ $('Input Format').first().json.flowName }}",
              "rightValue": "=discord",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        96,
        -112
      ],
      "id": "62d0c7eb-9fa6-42a3-af1b-e3305519ac0d",
      "name": "If1",
      "alwaysOutputData": false
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        -3808,
        2208
      ],
      "id": "cc9f0806-85d4-4e0c-9830-5cd042c36628",
      "name": "When clicking â€˜Execute workflowâ€™"
    },
    {
      "parameters": {
        "mode": "delete",
        "deleteMode": "all"
      },
      "type": "@n8n/n8n-nodes-langchain.memoryManager",
      "typeVersion": 1.1,
      "position": [
        -3552,
        2080
      ],
      "id": "29204b5b-ec9e-4e2b-b011-32ad1fcdade7",
      "name": "Chat Memory Manager1"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "7a336883-1379-438d-aa08-95d1af38ef80",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -5488,
        1360
      ],
      "id": "a37063a9-ca7d-47f0-b0fa-14c3344c02f8",
      "name": "Voice Webhook",
      "webhookId": "7a336883-1379-438d-aa08-95d1af38ef80"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "aef5864d-d96f-4d13-a95e-6d58ae73302e",
              "name": "chatInput",
              "value": "={{ $json.body.toolInput }}",
              "type": "string"
            },
            {
              "id": "30184b2f-9c9b-4ce9-b5ba-1a77f9e832af",
              "name": "flowName",
              "value": "voice",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -5312,
        1360
      ],
      "id": "c2f5e0be-2466-4df8-a00e-c08b5fa5c47b",
      "name": "Voice Format"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "4b37286d-f7a8-4be8-8724-c5e5c0449cc9",
              "leftValue": "={{ $('Input Format').first().json.flowName }}",
              "rightValue": "=voice",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        96,
        128
      ],
      "id": "07a96e1f-dafa-47db-84ae-d0593ba8d1c5",
      "name": "If2",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c2c0d414-ffbd-4e29-9e9c-03907ad5f055",
              "name": "text",
              "value": "=æ¥æ”¶åˆ°æŒ‡ä»¤ : {{ $json.chatInput }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -4832,
        -112
      ],
      "id": "d7e8b05e-5f12-4a43-af02-8ee5c5fbc282",
      "name": "æ¥æ”¶ç¢ºèª"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c2c0d414-ffbd-4e29-9e9c-03907ad5f055",
              "name": "text",
              "value": "=é¡åˆ¥ç‚º{{ $('æ•´åˆ').item.json.category }} å®Œæˆéœ€æ±‚åˆ†æ ",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2976,
        -112
      ],
      "id": "9562e642-a295-40bc-9498-0406958b9e2f",
      "name": "åˆ†æ"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c2c0d414-ffbd-4e29-9e9c-03907ad5f055",
              "name": "text",
              "value": "=åŸ·è¡ŒæŒ‡ä»¤ {{ $json.description.replace(/\\s+/g, '') }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2528,
        -112
      ],
      "id": "3a0b8f36-7876-4758-86da-b724048d8dd3",
      "name": "å‘½ä»¤"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c2c0d414-ffbd-4e29-9e9c-03907ad5f055",
              "name": "text",
              "value": "={{ $json.text }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -2144,
        -112
      ],
      "id": "42123f7b-8165-4765-b470-a18c3740a7ac",
      "name": "æ•´åˆ1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.4,
      "position": [
        320,
        112
      ],
      "id": "adbc65bc-852c-4091-8a59-bb2f682a0d2e",
      "name": "Respond to Webhook"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": []
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        544,
        112
      ],
      "id": "e9bcae16-46dd-4040-a703-1470cae25396",
      "name": "Empty1"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": []
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        544,
        -128
      ],
      "id": "c478cc73-dd55-4dbc-8d55-37c1c04465ab",
      "name": "Empty2"
    },
    {
      "parameters": {
        "inputText": "={{ $json.chatInput }}",
        "categories": {
          "categories": [
            {
              "category": "è¨˜å¸³",
              "description": "ä¸è«–æ˜¯ä»»ä½•é¡åˆ¥ï¼Œåªè¦å’Œè¨˜å¸³æœ‰é—œæ›´æ–°ã€æ–°å¢ã€åˆªé™¤éƒ½å±¬æ–¼é€™é¡"
            },
            {
              "category": "èŠå¤©",
              "description": "å¦‚æœæ˜¯è©¢å•å•é¡Œã€èŠå¤©ã€ä¼‘é–’ã€å•å€™ï¼Œæ—¥å¸¸å°è©±å…¨éƒ½å±¬æ–¼é€™é¡"
            }
          ]
        },
        "options": {
          "systemPromptTemplate": "Please classify the text provided by the user into one of the following categories: {categories}, and use the provided formatting instructions below. Don't explain, and only output the json. "
        }
      },
      "type": "@n8n/n8n-nodes-langchain.textClassifier",
      "typeVersion": 1.1,
      "position": [
        -4592,
        976
      ],
      "id": "cd3b2bef-95c1-4179-a17c-348fde8b773b",
      "name": "æ„åœ–åˆ†é¡å™¨1",
      "alwaysOutputData": false,
      "executeOnce": false,
      "notesInFlow": false
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "e1b031f6-15fe-4831-a938-5e85e829608d",
              "name": "sessionId",
              "value": "={{ $json.sessionId }}",
              "type": "string"
            },
            {
              "id": "905e9082-fdaf-401c-8b0f-795e6ec52432",
              "name": "chatInput",
              "value": "={{ $json.chatInput }}",
              "type": "string"
            },
            {
              "id": "763fdc6d-4203-4312-951c-dfba0eb477ba",
              "name": "category",
              "value": "åŠ æ²¹",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3760,
        624
      ],
      "id": "b2e921e9-3b2b-4419-8091-eec1b4d70360",
      "name": "åŠ æ²¹"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "e1b031f6-15fe-4831-a938-5e85e829608d",
              "name": "sessionId",
              "value": "={{ $json.sessionId }}",
              "type": "string"
            },
            {
              "id": "905e9082-fdaf-401c-8b0f-795e6ec52432",
              "name": "chatInput",
              "value": "={{ $json.chatInput }}",
              "type": "string"
            },
            {
              "id": "763fdc6d-4203-4312-951c-dfba0eb477ba",
              "name": "category",
              "value": "å­¸æ ¡",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3760,
        768
      ],
      "id": "efebd279-33a6-4d37-9e01-8b13454da11c",
      "name": "å­¸æ ¡"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "e1b031f6-15fe-4831-a938-5e85e829608d",
              "name": "sessionId",
              "value": "={{ $json.sessionId }}",
              "type": "string"
            },
            {
              "id": "905e9082-fdaf-401c-8b0f-795e6ec52432",
              "name": "chatInput",
              "value": "={{ $json.chatInput }}",
              "type": "string"
            },
            {
              "id": "763fdc6d-4203-4312-951c-dfba0eb477ba",
              "name": "category",
              "value": "é ˜éŒ¢",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3760,
        912
      ],
      "id": "ab152f27-8506-49a5-94b7-f2897ec91c2b",
      "name": "é ˜éŒ¢"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "e1b031f6-15fe-4831-a938-5e85e829608d",
              "name": "sessionId",
              "value": "={{ $json.sessionId }}",
              "type": "string"
            },
            {
              "id": "905e9082-fdaf-401c-8b0f-795e6ec52432",
              "name": "chatInput",
              "value": "={{ $json.chatInput }}",
              "type": "string"
            },
            {
              "id": "763fdc6d-4203-4312-951c-dfba0eb477ba",
              "name": "category",
              "value": "è¦çš®",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -3760,
        1056
      ],
      "id": "ba6ffa7b-01d2-416b-bca7-c6d5d038d4c8",
      "name": "è¦çš®"
    },
    {
      "parameters": {
        "content": "## Notion Manager",
        "height": 592,
        "width": 2480
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -2944,
        544
      ],
      "id": "0b6f4ca2-3ce4-469f-bf76-8e46c54bce69",
      "name": "Sticky Note"
    }
  ],
  "pinData": {},
  "connections": {
    "When chat message received": {
      "main": [
        [
          {
            "node": "Chat Format",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ„åœ–è¾¨è­˜": {
      "ai_languageModel": [
        [
          {
            "node": "æ„åœ–åˆ†é¡å™¨",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "æ„åœ–åˆ†é¡å™¨1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "ä¼™é£Ÿ": {
      "main": [
        [
          {
            "node": "æ•´åˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "äº¤é€š": {
      "main": [
        [
          {
            "node": "æ•´åˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å…¶ä»–": {
      "main": [
        [
          {
            "node": "AI Agent1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notion Mgr": {
      "ai_languageModel": [
        [
          {
            "node": "Notion Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Notion æ“ä½œè¨˜æ†¶åº«": {
      "ai_memory": [
        [
          {
            "node": "Notion Agent",
            "type": "ai_memory",
            "index": 0
          },
          {
            "node": "Chat Memory Manager",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "Date Mgr": {
      "ai_tool": [
        [
          {
            "node": "Notion Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Create Page": {
      "ai_tool": [
        [
          {
            "node": "Notion Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Update Page": {
      "ai_tool": [
        [
          {
            "node": "Notion Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Get DB": {
      "ai_tool": [
        [
          {
            "node": "Notion Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "æ„åœ–è¾¨è­˜1": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent",
            "type": "ai_languageModel",
            "index": 0
          },
          {
            "node": "Structured Output Parser",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "AI Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          },
          {
            "node": "åˆ†æ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Notion Agent",
            "type": "main",
            "index": 0
          },
          {
            "node": "å‘½ä»¤",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Notion Agent": {
      "main": [
        [
          {
            "node": "Empty",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Empty": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ„åœ–åˆ†é¡å™¨": {
      "main": [
        [
          {
            "node": "ä¼™é£Ÿ",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "äº¤é€š",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "åŠ æ²¹",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "å­¸æ ¡",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "é ˜éŒ¢",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "è¦çš®",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "èŠå¤© Bot": {
      "ai_languageModel": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "å°è©±è¨˜æ†¶åº«": {
      "ai_memory": [
        [
          {
            "node": "AI Agent1",
            "type": "ai_memory",
            "index": 0
          },
          {
            "node": "Chat Memory Manager1",
            "type": "ai_memory",
            "index": 0
          }
        ]
      ]
    },
    "æ•´åˆ": {
      "main": [
        [
          {
            "node": "AI Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ä»»å‹™ç¸½çµ": {
      "ai_languageModel": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "AI Agent1": {
      "main": [
        [
          {
            "node": "æ ¼å¼åŒ–è¼¸å‡º",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Basic LLM Chain": {
      "main": [
        [
          {
            "node": "æ ¼å¼åŒ–è¼¸å‡º1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ ¼å¼åŒ–è¼¸å‡º": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Discord Webhook": {
      "main": [
        [
          {
            "node": "Discord Format",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Discord Format": {
      "main": [
        [
          {
            "node": "Input Format",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Chat Format": {
      "main": [
        [
          {
            "node": "Input Format",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ ¼å¼åŒ–è¼¸å‡º1": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Input Format": {
      "main": [
        [
          {
            "node": "æ¥æ”¶ç¢ºèª",
            "type": "main",
            "index": 0
          },
          {
            "node": "æ„åœ–åˆ†é¡å™¨1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send a message1": {
      "main": [
        [
          {
            "node": "Empty2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If1": {
      "main": [
        [
          {
            "node": "Send a message1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "If2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When clicking â€˜Execute workflowâ€™": {
      "main": [
        [
          {
            "node": "Chat Memory Manager",
            "type": "main",
            "index": 0
          },
          {
            "node": "Chat Memory Manager1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Voice Webhook": {
      "main": [
        [
          {
            "node": "Voice Format",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Voice Format": {
      "main": [
        [
          {
            "node": "Input Format",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ¥æ”¶ç¢ºèª": {
      "main": [
        [
          {
            "node": "æ•´åˆ1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åˆ†æ": {
      "main": [
        [
          {
            "node": "æ•´åˆ1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å‘½ä»¤": {
      "main": [
        [
          {
            "node": "æ•´åˆ1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ•´åˆ1": {
      "main": [
        [
          {
            "node": "If1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If2": {
      "main": [
        [
          {
            "node": "Empty1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "æ ¼å¼åŒ–è¼¸å‡º3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Respond to Webhook": {
      "main": [
        [
          {
            "node": "Empty1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ„åœ–åˆ†é¡å™¨1": {
      "main": [
        [
          {
            "node": "æ„åœ–åˆ†é¡å™¨",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "å…¶ä»–",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å­¸æ ¡": {
      "main": [
        [
          {
            "node": "æ•´åˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¦çš®": {
      "main": [
        [
          {
            "node": "æ•´åˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é ˜éŒ¢": {
      "main": [
        [
          {
            "node": "æ•´åˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "åŠ æ²¹": {
      "main": [
        [
          {
            "node": "æ•´åˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "timezone": "Asia/Taipei",
    "callerPolicy": "workflowsFromSameOwner",
    "availableInMCP": false
  },
  "versionId": "58305d79-0002-42f8-957a-f0daf61af6ed",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "f8d23e1975e2e6a56edd35da6de0cad530183062d0b78e478a2ac38f6c9e4100"
  },
  "id": "UPdVCZrjCG2KRuqy",
  "tags": []
}